<html><head><meta charset="UTF-8"><link rel="import" href="sw-app.html"></head><body><div hidden="" by-vulcanize=""><dom-module id="sw-add-stock-dialog" assetpath="/">

    
    <template>
        <style>paper-dialog{min-width:280px;padding:0px 30px;}paper-dialog /deep/ input{text-transform:uppercase;}</style>
        <paper-dialog opened="" modal="" id="dialog">
            <h2>Enter stock symbol</h2>
            <paper-dialog-scrollable>
                <paper-input label="E.g. AAPL or GOOGL" id="symbol" autocapitalize="" autofocus="" maxlength="12" minlength="1" pattern="[a-ZA-Z0-9]" required="" error-message="Invalid stock symbol"></paper-input>
            </paper-dialog-scrollable>
            <div class="buttons">
                <paper-button on-tap="_cancelled">Cancel</paper-button>
                <paper-button on-tap="_confirmed">Accept</paper-button>
            </div>
        </paper-dialog>
    </template>

    
    <script>Polymer({is:"sw-add-stock-dialog",_confirmed:function(){if(this.$.symbol.validate()){var i=this.$.symbol.value.toUpperCase();this.fire("symbol-added",{symbol:i}),this.$.dialog.close()}},_cancelled:function(){this.fire("dialog-cancelled")}});</script>

</dom-module></div><dom-module id="sw-quotes">
    <template>
        <style>#stocks{height:100%;}vaadin-grid /deep/ .positive-change{color:#006400;}vaadin-grid /deep/ .negative-change{color:#ff0000;}.container{display:flex;flex-direction:column;height:100%;}.container vaadin-grid{flex-grow:1;}.container .toolbar{height:40px;padding:10px;align-self:flex-end;width:100%;background-color:#eeeeee;-webkit-box-shadow:0px -4px 11px 0px rgba(221, 221, 221, 1);-moz-box-shadow:0px -4px 11px 0px rgba(221, 221, 221, 1);box-shadow:0px -4px 11px 0px rgba(221, 221, 221, 1);z-index:1000;}.container .toolbar paper-fab{--paper-fab-background:#2778bd;float:right;margin-left:10px;}.container .toolbar paper-button{float:left;color:#AAAAAA;}vaadin-grid /deep/ .stockdetails{float:left;clear:left;font-size:11px;}</style>

        <div class="container">
            <vaadin-grid id="stocksGrid" items="{{stocks}}" selection-mode="single">
                <table>
                    <colgroup>
                        <col name="symbol">
                        <col name="value" min-width="100">
                        <col name="change" min-width="70">
                    </colgroup>
                    <thead>
                    <tr>
                        <th>Stock</th>
                        <th>Last Price</th>
                        <th>Change</th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </vaadin-grid>
            <div class="toolbar">
                <paper-button on-tap="_toggleList">
                    <iron-icon icon="vaadin-icons:lines-list"></iron-icon>
                </paper-button>
                <paper-fab icon="vaadin-icons:plus" mini="" id="addStock" on-tap="_showAddStockDialog"></paper-fab>
                <iron-collapse id="collapseRemoveButton">
                    <paper-fab icon="vaadin-icons:minus" mini="" id="removeStocks" on-tap="_removeStocks"></paper-fab>
                </iron-collapse>
            </div>
        </div>
        <iron-localstorage id="localStorage" name="sw-stocks" value="{{stocks}}" on-iron-localstorage-load-empty="initializeDefaultStocks" on-iron-localstorage-load="dataLoaded"></iron-localstorage>

        <yahoo-finance-quote on-response="_handleQuoteResponse" id="quoteRequest"></yahoo-finance-quote>
    </template>

    <script>var quotesView=void 0;Polymer({is:"sw-quotes",properties:{stocks:{type:Array,value:function(){return[]}}},ready:function(){quotesView=this,this.$.stocksGrid.cellClassGenerator=function(e){if("change"==e.columnName){var t=e.row.data.change;return parseFloat(t)>=0?"positive-change":"negative-change"}}},_showAddStockDialog:function(){var e=document.createElement("sw-add-stock-dialog");e.setAttribute("id","add-stock-dialog"),e.addEventListener("symbol-added",this._symbolAdded),e.addEventListener("dialog-cancelled",this._dialogCancelled),document.querySelector("body").appendChild(e)},_symbolAdded:function(e){function t(e,t){return e.symbol<t.symbol?-1:e.symbol>t.symbol?1:0}var s=e.detail.symbol,o={symbol:s,name:"",value:"N/A",change:"N/A",changePercent:"N/A",lastUpdate:"N/A"};quotesView.push("stocks",o),quotesView.stocks.sort(t),quotesView._updateStockQuotes(),document.querySelector("body").removeChild(document.getElementById("add-stock-dialog"))},_dialogCancelled:function(){document.querySelector("body").removeChild(document.getElementById("add-stock-dialog"))},_toggleList:function(){"multi"==this.$.stocksGrid.selection.mode?(this.$.stocksGrid.selection.mode="single",this.$.addStock.disabled=!1,this.$.collapseRemoveButton.opened=!1):"single"==this.$.stocksGrid.selection.mode&&(this.$.stocksGrid.selection.mode="multi",this.$.addStock.disabled=!0,this.$.collapseRemoveButton.opened=!0)},_removeStocks:function(){var e=this.$.stocksGrid.selection.selected();e.sort();for(var t=0;t<e.length;t++){var s=e[t]-t;this.splice("stocks",s,1)}this.$.stocksGrid.size=this.stocks.length,this.$.stocksGrid.refreshItems(),this._toggleList()},_handleQuoteResponse:function(e){function t(e){return n.symbol==e.symbol.toUpperCase()}for(var s=e.detail.list.resources,o=0;o<s.length;o++){var n=s[o].resource.fields,i=quotesView.stocks.find(t);i.symbol=n.symbol,i.name=n.name,i.value=parseFloat(n.price).toFixed(2),i.change=parseFloat(n.change).toFixed(2),i.changePercent=parseFloat(n.chg_percent).toFixed(2),i.lastUpdate=n.utctime}quotesView.$.stocksGrid.size=quotesView.stocks.length,quotesView.$.stocksGrid.refreshItems(),quotesView.$.localStorage.save()},_updateStockQuotes:function(){var e=this,t=new Promise(function(t,s){if(0==e.stocks.length)return void s("No stocks in list");for(var o=[],n=0;n<e.stocks.length;n++)o.push(e.stocks[n].symbol);e.$.quoteRequest.requestQuotes(o),t()});t.then(function(){e.$.stocksGrid.size=e.stocks.length,e.$.stocksGrid.refreshItems()},function(e){console.log(e)})},dataLoaded:function(){this._setRenderers(),this._updateStockQuotes()},_setRenderers:function(){this.$.stocksGrid.columns[0].renderer=function(e){e.element.innerHTML="<div>"+e.row.data.symbol+"<br /><span class='stockdetails'>"+e.row.data.name+"</span></div>"},this.$.stocksGrid.columns[2].renderer=function(e){e.element.innerHTML=e.row.data.change+"<br />"+e.row.data.changePercent+"%"}},initializeDefaultStocks:function(){this._setRenderers(),this.stocks=[{symbol:"AAPL",name:"Apple Inc",value:"N/A",change:"N/A",changePercent:"N/A",lastUpdate:"N/A"},{symbol:"GOOGL",name:"Alphabet Inc",value:"N/A",change:"N/A",changePercent:"N/A",lastUpdate:"N/A"},{symbol:"TSLA",name:"Tesla Motors Inc",value:"N/A",change:"N/A",changePercent:"N/A",lastUpdate:"N/A"}],this._updateStockQuotes()}});</script>

</dom-module>
</body></html>
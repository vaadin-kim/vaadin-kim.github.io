<!DOCTYPE html><html><head>
  <meta charset="utf-8">
  <title>vaadin-month-calendar basic tests</title>
  <script src="../../web-component-tester/browser.js"></script>
  <script src="common.js"></script>

  <link rel="import" href="../vaadin-month-calendar.html">
</head>

<body>
  <test-fixture id="vaadin-month-calendar">
    <template>
      <vaadin-month-calendar></vaadin-month-calendar>
    </template>
  </test-fixture>

  <script>describe("vaadin-month-calendar",function(){function e(e){var n=[31,29,31,30,31,30,31,31,30,31,30,31];return function(a){t.month=new Date(2016,e,1),Polymer.Base.async(function(){var o=t.$.monthGrid.querySelectorAll("div:not(.weekday):not(:empty)").length;expect(o).to.equal(n[e]),a()})}}var t;beforeEach(function(e){t=fixture("vaadin-month-calendar"),t.i18n=getDefaultI18n(),t.month=new Date(2016,1,1),valueChangedSpy=sinon.spy(),t.addEventListener("selected-date-changed",valueChangedSpy),Polymer.Base.async(e)});for(var n=0;12>n;n++)it("should render correct number of days for 2016/"+(n+1),e(n));it("should render days in correct order by default",function(){var e=t.$.monthGrid.querySelectorAll("div.weekday"),n=Array.prototype.map.call(e,function(e){return e.textContent});expect(n).to.eql(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"])}),it("should render days in correct order by first day of week",function(e){t.set("i18n.firstDayOfWeek",1),Polymer.Base.async(function(){var n=t.$.monthGrid.querySelectorAll("div.weekday"),a=Array.prototype.map.call(n,function(e){return e.textContent});expect(a).to.eql(["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]),e()})}),it("should re-render after changing the month",function(e){t.month=new Date(2e3,0,1),Polymer.Base.async(function(){var n=t.$.monthGrid.querySelectorAll("div:not(.weekday):not(:empty)").length;expect(n).to.equal(31),expect(t.$.title.textContent).to.equal("January 2000"),e()})}),it("should fire value change on tap",function(){var e=t.$.monthGrid.querySelectorAll("div:not(.weekday):not(:empty)");tap(e[10]),expect(valueChangedSpy.calledOnce).to.be["true"]}),it("should fire date-tap on tap",function(){tapSpy=sinon.spy(),t.addEventListener("date-tap",tapSpy);var e=t.$.monthGrid.querySelectorAll("div:not(.weekday):not(:empty)");tap(e[10]),expect(tapSpy.calledOnce).to.be["true"],tap(e[10]),expect(tapSpy.calledTwice).to.be["true"]}),it("should not fire value change on tapping an empty cell",function(){var e=t.$.monthGrid.querySelector("div:not(.weekday):empty");tap(e),expect(valueChangedSpy.called).to.be["false"]}),it("should update value on tap",function(){for(var e=t.$.monthGrid.querySelectorAll("div:not(.weekday):not(:empty)"),n=0;n<e.length;n++)10===e[n].date.getDate()&&tap(e[n]);expect(t.selectedDate.getFullYear()).to.equal(2016),expect(t.selectedDate.getMonth()).to.equal(1),expect(t.selectedDate.getDate()).to.equal(10)}),it("should not react if the tap takes more than 300ms",function(e){tapSpy=sinon.spy(),t.addEventListener("date-tap",tapSpy);var n=t.$.monthGrid.querySelectorAll("div:not(.weekday):not(:empty)")[10];t._onMonthGridTouchStart(),t.async(function(){tap(n),expect(tapSpy.called).to.be["false"],e()},350)}),it("should not react if ignoreTaps is on",function(){tapSpy=sinon.spy(),t.addEventListener("date-tap",tapSpy),t.ignoreTaps=!0;var e=t.$.monthGrid.querySelectorAll("div:not(.weekday):not(:empty)")[10];tap(e),expect(tapSpy.called).to.be["false"]}),it("should prevent default on touchend",function(){var e=sinon.spy(),n=new CustomEvent("touchend",{bubbles:!0,cancelable:!0});n.changedTouches=[{}],n.preventDefault=e;var a=t.$.monthGrid.querySelector("div:not(.weekday):not(:empty)");a.dispatchEvent(n),expect(e).to.have.been.called}),it("should work with sub 100 years",function(e){var n=new Date(0,0);n.setFullYear(99),t.month=n,t.async(function(){var a=t.$.monthGrid.querySelector("div:not(.weekday):not(:empty)").date;expect(a.getFullYear()).to.equal(n.getFullYear()),e()})}),describe("i18n",function(){beforeEach(function(e){t.i18n={monthNames:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kesäkuu_heinäkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),firstDayOfWeek:1,formatTitle:function(e,t){return e+"-"+t}},Polymer.Base.async(e)}),it("should render days in correct locale",function(){var e=t.$.monthGrid.querySelectorAll("div.weekday"),n=Array.prototype.map.call(e,function(e){return e.textContent});expect(n).to.eql(["ma","ti","ke","to","pe","la","su"])}),it("should render month name in correct locale",function(){expect(t.$.title.textContent).to.equal("helmikuu-2016")})})});</script>




</body></html>
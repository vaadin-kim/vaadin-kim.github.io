"use strict";function cleanDone(e){return function(t){t&&(t=new Error(chalk.red(t.message||t)),t.showStack=!1),e(t)}}function localAddress(){var e,t,s=require("os").networkInterfaces();return Object.keys(s).forEach(function(r){s[r].forEach(function(s){"IPv4"!=s.family||s.internal||(e||(e=s.address),/tun/.test(r)&&(t=s.address))})}),t||e}function test(e,t){wct(e,cleanDone(t))}function testSauce(e,t){test({expanded:!0,browserOptions:{name:localAddress()+" / "+new Date,build:"vaadin-date-picker"},plugins:{sauce:{username:args.sauceUsername,accessKey:args.sauceAccessKey,browsers:e}},extraScripts:"shadow"===args.dom?["test/enable-shadow-dom.js"]:[],root:".",webserver:{port:2e3,hostname:localAddress()}},t)}var args=require("yargs").argv,chalk=require("chalk"),wct=require("web-component-tester").test,gulp=require("gulp"),jscs=require("gulp-jscs"),jshint=require("gulp-jshint"),htmlExtract=require("gulp-html-extract"),sourcemaps=require("gulp-sourcemaps"),ts=require("gulp-typescript"),typings=require("gulp-typings");gulp.task("test:desktop",function(e){testSauce(["Windows 10/chrome@48","Windows 10/firefox@44","Windows 10/microsoftedge@13","Windows 10/internet explorer@11","OS X 10.11/safari@9.0"],e)}),gulp.task("test:mobile",function(e){testSauce(["OS X 10.11/iphone@9.2","OS X 10.11/ipad@9.2","Linux/android@5.1"],e)}),gulp.task("lint:js",function(){return gulp.src(["*.js","test/*.js"]).pipe(jshint()).pipe(jshint.reporter()).pipe(jshint.reporter("fail")).pipe(jscs()).pipe(jscs.reporter()).pipe(jscs.reporter("fail"))}),gulp.task("lint:html",function(){return gulp.src(["*.html","demo/*.html","test/*.html"]).pipe(htmlExtract({sel:"script, code-example code"})).pipe(jshint()).pipe(jshint.reporter()).pipe(jshint.reporter("fail")).pipe(jscs()).pipe(jscs.reporter()).pipe(jscs.reporter("fail"))}),gulp.task("test:desktop:shadow",function(e){args.dom="shadow",testSauce(["Windows 10/chrome@48","Windows 10/firefox@44","Windows 10/microsoftedge@13","OS X 10.11/safari@9.0"],e)}),gulp.task("test:mobile:shadow",function(e){args.dom="shadow",testSauce(["OS X 10.11/iphone@9.2","OS X 10.11/ipad@9.2","Linux/android@5.1"],e)}),gulp.task("test",["lint:js","lint:html"],function(e){args.dom="shadow",test({plugins:{local:{browsers:["chrome"]}}},e)}),gulp.task("typings",function(){return gulp.src("directives/typings.json").pipe(typings())}),gulp.task("ng2",["typings"],function(){["directives","test/angular2"].forEach(function(e){gulp.src([e+"/*.ts","directives/typings/main/**/*.d.ts"]).pipe(sourcemaps.init()).pipe(ts(ts.createProject("directives/tsconfig.json"))).pipe(sourcemaps.write(".")).pipe(gulp.dest(e))})}),gulp.task("ng2:watch",function(){gulp.watch("directives/*.ts",["ng2"]),gulp.watch("test/angular2/*.ts",["ng2"])});